window.Eurus.loadedScript.includes("event-calendar.js")||(window.Eurus.loadedScript.push("event-calendar.js"),requestAnimationFrame((()=>{document.addEventListener("alpine:init",(()=>{Alpine.data("xEventCalendar",(e=>({open:!1,eventDetails:{},addToCal(t){let n="",i="";this.eventDetails=e,e||(this.eventDetails=JSON.parse(JSON.stringify(Alpine.store("xEventCalendarDetail").eventDetail)));let a=this.handleTime(this.eventDetails.start_year,this.eventDetails.month,this.eventDetails.day,this.eventDetails.start_hour,this.eventDetails.start_minute,t);switch(i=this.eventDetails.show_end_date?this.handleTime(this.eventDetails.end_year,this.eventDetails.end_month,this.eventDetails.end_day,this.eventDetails.end_hour,this.eventDetails.end_minute,t):this.eventDetails.show_end_time?this.handleTime(this.eventDetails.start_year,this.eventDetails.month,this.eventDetails.day,this.eventDetails.end_hour,this.eventDetails.end_minute,t):a,t){case"apple":this.createDownloadICSFile(0,a,i,this.eventDetails.title,this.eventDetails.details,this.eventDetails.location,"apple");break;case"google":n="http://www.google.com/calendar/event?action=TEMPLATE&trp=false&text="+encodeURIComponent(this.eventDetails.title)+"&dates="+a+"/"+i+"&location="+encodeURIComponent(this.eventDetails.location)+"&details="+encodeURIComponent(this.eventDetails.details),window.open(n);break;case"outlook":n="https://outlook.live.com/calendar/action/compose?rru=addevent&startdt="+a+"&enddt="+i+"&subject="+encodeURIComponent(this.eventDetails.title)+"&location="+encodeURIComponent(this.eventDetails.location)+"&body="+encodeURIComponent(this.eventDetails.details),window.open(n);break;case"yahoo":n="http://calendar.yahoo.com/?v=60&st="+a+"&et="+i+"&title="+encodeURIComponent(this.eventDetails.title),window.open(n);break;case"ical":this.createDownloadICSFile(0,a,i,this.eventDetails.title,this.eventDetails.details,this.eventDetails.location,"ical");break;default:console.log("Sorry, error")}},handleTime(e,t,n,i,a,s){let o=new Date;return"google"==s||"yahoo"==s?(o=new Date(Date.UTC(e,this.getMonthNumber(t),parseInt(n),parseInt(i),parseInt(a))),o.setTime(o.getTime()+60*(-1*parseInt(this.eventDetails.timezone)*60-o.getTimezoneOffset())*1e3),o.toISOString().split("Z")[0].replace(".000","").replace(/[^A-Z0-9]/gi,"")):(o=new Date(e,this.getMonthNumber(t),parseInt(n),parseInt(i),parseInt(a)),o.setTime(o.getTime()+60*(-1*parseInt(this.eventDetails.timezone)*60-o.getTimezoneOffset())*1e3),"apple"==s?o.toISOString().split("Z")[0].replace(".000","").replace(/[^A-Z0-9]/gi,""):o.toISOString())},getMonthNumber:e=>new Date(`${e} 1, 2022`).getMonth(),createDownloadICSFile(e,t,n,i,a,s,o){let l="BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:Calendar\nCALSCALE:GREGORIAN\nMETHOD:PUBLISH\nBEGIN:VTIMEZONE\nTZID:"+e+"\nEND:VTIMEZONE\nBEGIN:VEVENT\nSUMMARY:"+i+"\nUID:@Default\nSEQUENCE:0\nSTATUS:CONFIRMED\nTRANSP:TRANSPARENT\nDTSTART;TZID="+e+":"+t+"\nDTEND;TZID="+e+":"+n+"\nLOCATION:"+s+"\nDESCRIPTION:"+a+"\nEND:VEVENT\nEND:VCALENDAR\n";this.download(i+".ics",l,o)},download(e,t,n){var i=document.createElement("a");if("ical"==n)i.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t));else if("apple"==n){var a=new Blob([t],{type:"text/calendar;charset=utf-8"});i.href=window.URL.createObjectURL(a)}i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}}))),Alpine.store("xEventCalendarDetail",{show:!1,eventDetail:{},handleEventSelect(){var e=this;const t=JSON.parse(JSON.stringify(this.eventDetail));if(document.addEventListener("shopify:section:select",(function(t){0==t.target.classList.contains("section-event-calendar")&&(window.Alpine?e.close():document.addEventListener("alpine:initialized",(()=>{e.close()})))})),t&&t.blockID&&t.sectionID){this.eventDetail=xParseJSON(document.getElementById("x-data-event-"+t.blockID).getAttribute("x-event-data"));let e=document.getElementById("EventDescription-"+this.eventDetail.sectionID);e.innerHTML=this.eventDetail.description,e.innerHTML=e.textContent}},load(e,t){this.eventDetail=xParseJSON(e.closest("#x-data-event-"+t).getAttribute("x-event-data"));let n=document.getElementById("EventDescription-"+this.eventDetail.sectionID);this.sectionID=this.eventDetail.sectionID,n.innerHTML=this.eventDetail.description,n.innerHTML=n.textContent,this.showEventCalendarDetail()},showEventCalendarDetail(){this.show=!0,Alpine.store("xPopup").open=!0},close(){this.show=!1,Alpine.store("xPopup").open=!1}})}))})));
