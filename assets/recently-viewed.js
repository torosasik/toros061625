window.Eurus.loadedScript.includes("recently-viewed.js")||(window.Eurus.loadedScript.push("recently-viewed.js"),requestAnimationFrame((()=>{document.addEventListener("alpine:init",(()=>{Alpine.store("xProductRecently",{show:!1,productsToShow:0,productsToShowMax:10,init(){document.getElementById("shopify-section-recently-viewed")&&(this.productsToShow=document.getElementById("shopify-section-recently-viewed").getAttribute("x-products-to-show"))},showProductRecently(){localStorage.getItem("recently-viewed")?.length?this.show=!0:this.show=!1},setProduct(e){let t=[];if(localStorage.getItem("recently-viewed")?.length){t=JSON.parse(localStorage.getItem("recently-viewed")),t=[...t.filter((t=>t!==e))].filter(((e,t)=>t<this.productsToShowMax)),this.show=!0;let o=[e,...t];localStorage.setItem("recently-viewed",JSON.stringify(o))}else this.show=!1,localStorage.setItem("recently-viewed",JSON.stringify([e]))},getProductRecently(e,t){let o=[];if(!localStorage.getItem("recently-viewed")?.length)return;o=JSON.parse(localStorage.getItem("recently-viewed")),o=t?[...o.filter((e=>e!==t))]:o,o=o.slice(0,this.productsToShow);const r=document.getElementById("shopify-section-recently-viewed");let i=o.map((e=>"id:"+e)).join(" OR ");var n=`${Shopify.routes.root}search?section_id=${e}&type=product&q=${i}`;fetch(n).then((e=>{if(!e.ok){var t=new Error(e.status);throw console.log(t),t}return e.text()})).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").querySelector("#shopify-section-recently-viewed").innerHTML;r.innerHTML=t})).catch((e=>{throw e}))},clearStory(){!0===confirm("Are you sure you want to clear your recently viewed products?")&&(localStorage.removeItem("recently-viewed"),this.show=!1)}})}))})));
