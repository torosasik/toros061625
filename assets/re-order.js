window.Eurus.loadedScript.includes("re-order.js")||(window.Eurus.loadedScript.push("re-order.js"),requestAnimationFrame((()=>{document.addEventListener("alpine:init",(()=>{Alpine.store("xReOrder",{show:!1,orderName:"",itemsCart:"",itemsCartNew:[],errorMessage:!1,loading:!1,clearSuccess:!1,loadingClearCart:!1,disableReorder:!1,load(e,t){this.errorMessage=!1,this.showReorderPopup();let r=e.closest(".re-order-action").querySelector(".x-order-data").getAttribute("x-order-data");this.orderName=t,this.itemsCart=JSON.parse(r).map((e=>e.variant_available&&e.available?e:{...e,disable:!0})),this.disableReorder=-1==this.itemsCart.findIndex((e=>!e.disable)),this.itemsCartNew=this.itemsCart},setItemsCart(e){let t=[];this.itemsCartNew.forEach((r=>{r.id==e.id&&r.variant_id==e.variant_id&&(r.quantity=e.quantity),t.push(r)})),this.itemsCartNew=t},handleAddToCart(e){this.loading=!0,this.clearSuccess=!1;let t=[],r=new FormData;JSON.parse(JSON.stringify(this.itemsCartNew)).filter((e=>!e.disable&&t.push({id:e.variant_id,quantity:e.quantity}))),r.append("sections",Alpine.store("xCartHelper").getSectionsToRender().map((e=>e.id))),r.append("sections_url",window.location.pathname),r.append("items",JSON.stringify(t)),fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:t,sections:Alpine.store("xCartHelper").getSectionsToRender().map((e=>e.id))})}).then((e=>e.json())).then((t=>{if("422"==t.status){const r=e.closest(".reorder-popup").querySelector(".cart-warning");return this.errorMessage=!0,void(r&&(r.textContent=t.description))}this.closeReorderPopup(),Alpine.store("xCartHelper").getSectionsToRender().forEach((e=>{const r=document.querySelector(e.selector);r&&t.sections[e.id]&&(r.innerHTML=getSectionInnerHTML(t.sections[e.id],e.selector))})),Alpine.store("xQuickView")&&Alpine.store("xQuickView").show&&(Alpine.store("xQuickView").show=!1),Alpine.store("xPopup").open=!1,Alpine.store("xMiniCart").openCart(),Alpine.store("xCartHelper").currentItemCount=parseInt(document.querySelector("#cart-icon-bubble span").innerHTML),document.dispatchEvent(new CustomEvent("eurus:cart:items-changed"))})).catch((e=>{console.error("Error:",e)})).finally((()=>{this.loading=!1}))},clearCart(){this.loadingClearCart=!0,this.errorMessage=!1,fetch(window.Shopify.routes.root+"cart/clear.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sections:Alpine.store("xCartHelper").getSectionsToRender().map((e=>e.id))})}).then((e=>e.json())).then((e=>{this.clearSuccess=!0,Alpine.store("xCartHelper").getSectionsToRender().forEach((t=>{const r=document.querySelector(t.selector);r&&e.sections[t.id]&&(r.innerHTML=getSectionInnerHTML(e.sections[t.id],t.selector))})),Alpine.store("xCartHelper").currentItemCount=parseInt(document.querySelector("#cart-icon-bubble span").innerHTML),document.dispatchEvent(new CustomEvent("eurus:cart:items-changed"))})).catch((e=>{console.error("Error:",e)})).finally((()=>{this.loadingClearCart=!1}))},showReorderPopup(){this.show=!0,Alpine.store("xPopup").open=!0},closeReorderPopup(){this.show=!1,this.clearSuccess=!1,this.errorMessage=!1,Alpine.store("xPopup").open=!1}})}))})));
