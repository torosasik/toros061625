requestAnimationFrame((()=>{document.addEventListener("alpine:init",(()=>{Alpine.store("xQuickView",{sectionId:window.xQuickView.sectionId,enabled:window.xQuickView.enabled,buttonLabel:window.xQuickView.buttonLabel,show_atc_button:window.xQuickView.show_atc_button,btn_atc_bottom:window.xQuickView.atc_btn_bottom,show:!1,loading:!1,currentVariant:"",cachedResults:[],cachedfetch:[],loadedChooseOptions:[],loadedChooseOptionsID:[],selected:!1,addListener(){document.addEventListener("eurus:cart:items-changed",(()=>{this.cachedResults=[]}))},showBtn(e,t,o){this.enabled=e,this.buttonLabel=o,this.show_atc_button=t},load(e,t,o){let n=document.getElementById("current-variant-"+o).innerText,i=n?`${e}?variant=${n}&section_id=${this.sectionId}`:`${e}?section_id=${this.sectionId}`;return i=i.replace(/\s+/g,""),this.cachedResults[i]?(document.getElementById("quickview-product-content").innerHTML=this.cachedResults[i],!0):(this.cachedfetch[i]||(this.loading=!0,this.cachedfetch[i]=!0,fetch(i).then((e=>e.text())).then((e=>{const t=(new DOMParser).parseFromString(e,"text/html").getElementById("quickview-product-content").innerHTML;document.getElementById("quickview-product-content").innerHTML=t,this.cachedResults[i]=t})).finally((()=>{this.loading=!1,this.cachedfetch[i]=!1}))),!0)},async loadChooseOptions(e,t,o){let n=document.getElementById("current-variant-"+o).innerText,i=n?`${e}?variant=${n}&section_id=choose-option`:`${e}?section_id=choose-option`;var s={attributes:{choose_option_id:o}};const c=document.getElementById("choose-options-content-"+o),d=n?`${o}-${n}`:o;let a=i+"_choose-options",h=document.getElementById("choose-options-"+o).querySelector(".choose-options"),r=document.getElementById("choose-options-"+o).querySelector(".icon-loading");if(c&&this.loadedChooseOptionsID[d]&&this.loadedChooseOptions[a])return h.innerHTML=this.loadedChooseOptions[a],!0;try{r&&r.classList.remove("hidden");const e=await fetch(Shopify.routes.root+"cart/update",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(s)}),t=await e.json();this.loadedChooseOptionsID[d]=!0,await this.renderChooseOptions(i,t.attributes.choose_option_id)}catch(e){console.log(e)}},async renderChooseOptions(e,t){let o=e+"_choose-options",n=document.getElementById("choose-options-"+t).querySelector(".choose-options");if(document.getElementById("choose-options-content-"+t)&&this.loadedChooseOptions[o])return n.innerHTML=this.loadedChooseOptions[o],!0;try{const i=await fetch(e),s=await i.text(),c=(new DOMParser).parseFromString(s,"text/html").getElementById("choose-options-content").innerHTML;c&&(n.innerHTML=c,this.loadedChooseOptions[o]=c);let d=document.getElementById("choose-options-"+t).querySelector(".icon-loading");d&&d.classList.add("hidden")}catch(e){console.log(e)}},open(){this.show=!0,Alpine.store("xPopup").open=!0},close(){this.show=!1,Alpine.store("xPopup").open=!1},focusQuickView(e,t){this.selected||Alpine.store("xFocusElement").trapFocus(e,t)},removeFocusQuickView(){if(!this.selected){const e=document.getElementById("button_quickview");Alpine.store("xFocusElement").removeTrapFocus(e)}}})}))}));
