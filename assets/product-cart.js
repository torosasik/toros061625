window.Eurus.loadedScript.includes("product-cart.js")||(window.Eurus.loadedScript.push("product-cart.js"),requestAnimationFrame((()=>{document.addEventListener("alpine:init",(()=>{Alpine.data("xProductCart",(e=>({loading:!1,errorMessage:!1,buttonSubmit:"",error_message_wrapper:{},stopAction:!1,async addToCart(t,r){if(t.preventDefault(),r){var i=this.$el.closest(".product-info");if(i){var s=i.querySelectorAll(".customization-picker");this.stopAction=!1,s.length&&s.forEach((e=>{(e.required&&""==e.value||e.classList.contains("validate-checkbox"))&&(e.classList.add("required-picker"),this.stopAction=!0)}))}if(this.stopAction)return!0}if(this.loading=!0,this.$refs.gift_wrapping_checkbox&&this.$refs.gift_wrapping_checkbox.checked&&e){const t={items:[{id:e,quantity:1}]},r=await window.fetch("/cart/add.js",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify(t)}),i=await r.json();if(!r.ok)return void(422==i.status&&(this.$refs.gift_wrapping_error.textContent=i.description,this.loading=!1,setTimeout((()=>{this.$refs.gift_wrapping_error.textContent=""}),5e3)))}let o=new FormData(this.$refs.product_form);o.append("sections",Alpine.store("xCartHelper").getSectionsToRender().map((e=>e.id))),o.append("sections_url",window.location.pathname),await fetch(`${Eurus.cart_add_url}`,{method:"POST",headers:{Accept:"application/javascript","X-Requested-With":"XMLHttpRequest"},body:o}).then((e=>e.json())).then((e=>{"422"==e.status?("object"==typeof e.errors?(this.error_message_wrapper=e.errors,document.querySelector(".recipient-error-message").classList.remove("hidden")):(this.errorMessage=!0,this.$refs.error_message&&(this.$refs.error_message.textContent=e.description)),Alpine.store("xMiniCart")&&Alpine.store("xMiniCart").reLoad()):(document.querySelector(".recipient-error-message")&&document.querySelector(".recipient-error-message").classList.add("hidden"),this.error_message_wrapper={},Alpine.store("xCartHelper").getSectionsToRender().forEach((t=>{const r=document.querySelector(t.selector);r&&e.sections[t.id]&&(r.innerHTML=getSectionInnerHTML(e.sections[t.id],t.selector))})),Alpine.store("xQuickView")&&Alpine.store("xQuickView").show&&(Alpine.store("xQuickView").show=!1),Alpine.store("xPopup").open=!1,Alpine.store("xMiniCart").openCart(),Alpine.store("xCartHelper").currentItemCount=parseInt(document.querySelector("#cart-icon-bubble span").innerHTML),document.dispatchEvent(new CustomEvent("eurus:cart:items-changed")))})).catch((e=>{console.error("Error:",e)})).finally((()=>{this.loading=!1,this.$refs.gift_wrapping_checkbox&&(this.$refs.gift_wrapping_checkbox.checked=!1)}))}})))}))})));
